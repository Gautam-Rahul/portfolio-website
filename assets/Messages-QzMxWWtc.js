import{r as l,j as e,L as M,o,T as _,P as E,x as C,Q as F,t as u}from"./index-CJjfg70M.js";const S=()=>{const[n,x]=l.useState([]),[f,p]=l.useState(!0),[b,m]=l.useState(null),[s,g]=l.useState(null),[h,c]=l.useState(!1),[k,y]=l.useState(null);l.useEffect(()=>{(async()=>{try{p(!0);const{data:t}=await u.get("/contact");t.success&&x(t.contacts)}catch(t){console.error("Error fetching messages:",t),m("Failed to load messages. Please try again later.")}finally{p(!1)}})()},[]);const N=async a=>{var t,i;if(g(a),!a.read)try{c(!0),(await u.put(`/contact/${a._id}/read`)).data.success&&(x(n.map(d=>d._id===a._id?{...d,read:!0}:d)),g(d=>({...d,read:!0})))}catch(r){console.error("Error marking message as read:",r),m(((i=(t=r.response)==null?void 0:t.data)==null?void 0:i.message)||"Failed to mark message as read.")}finally{c(!1)}},v=async a=>{var t,i;try{c(!0),(await u.delete(`/contact/${a}`)).data.success&&(x(d=>d.filter(w=>w._id!==a)),s&&s._id===a&&g(null))}catch(r){console.error("Error deleting message:",r),m(((i=(t=r.response)==null?void 0:t.data)==null?void 0:i.message)||"Failed to delete message. Please try again.")}finally{y(null),c(!1)}},j=a=>{const t={year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(a).toLocaleDateString(void 0,t)};return f?e.jsx(M,{}):e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold mb-2 text-gray-900 dark:text-white",children:"Messages"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8",children:"Manage contact form submissions"}),b&&e.jsx("div",{className:"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 p-4 rounded-lg mb-6",children:e.jsx("p",{children:b})}),n.length>0?e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsxs("div",{className:"w-full md:w-1/3 bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden",children:[e.jsxs("h2",{className:"p-4 border-b border-gray-200 dark:border-gray-700 font-medium text-gray-800 dark:text-gray-200",children:["All Messages (",n.length,")"]}),e.jsx("div",{className:"overflow-y-auto max-h-[600px]",children:n.map(a=>e.jsx("div",{onClick:()=>N(a),className:`p-4 border-b border-gray-200 dark:border-gray-700 cursor-pointer transition-colors duration-200 ${s&&s._id===a._id?"bg-blue-50 dark:bg-blue-900/20":"hover:bg-gray-50 dark:hover:bg-gray-750"} ${a.read?"":"bg-blue-50 dark:bg-blue-900/10"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`mt-1 ${a.read?"text-gray-400 dark:text-gray-500":"text-blue-500"}`,children:a.read?e.jsx(_,{}):e.jsx(o,{})}),e.jsxs("div",{className:"flex-grow min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h3",{className:`font-medium truncate ${a.read?"text-gray-700 dark:text-gray-300":"text-gray-900 dark:text-white"}`,children:a.name}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 whitespace-nowrap ml-2",children:j(a.createdAt).split(",")[0]})]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:a.email}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1 line-clamp-2",children:a.message})]})]})},a._id))})]}),e.jsx("div",{className:"w-full md:w-2/3 bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden",children:s?e.jsxs("div",{children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsxs("h2",{className:"text-xl font-medium text-gray-800 dark:text-gray-200",children:["Message from ",s.name]}),e.jsx("button",{onClick:a=>{a.stopPropagation(),y(s._id)},disabled:h,className:"text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300","aria-label":"Delete message",children:e.jsx(E,{})})]}),k===s._id&&e.jsxs("div",{className:"m-4 p-3 bg-red-50 dark:bg-red-900/20 rounded-lg text-sm",children:[e.jsx("p",{className:"text-red-700 dark:text-red-400 mb-2",children:"Are you sure you want to delete this message?"}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsxs("button",{onClick:a=>{a.stopPropagation(),y(null)},className:"px-3 py-1 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-300 dark:hover:bg-gray-600",children:[e.jsx(C,{className:"inline mr-1"})," Cancel"]}),e.jsxs("button",{onClick:a=>{a.stopPropagation(),v(s._id)},className:"px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600",disabled:h,children:[e.jsx(F,{className:"inline mr-1"})," ",h?"Deleting...":"Confirm"]})]})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"From:"}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:s.name}),e.jsxs("p",{className:"text-blue-600 dark:text-blue-400",children:["<",s.email,">"]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Date:"}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:j(s.createdAt)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Message:"}),e.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg whitespace-pre-wrap text-gray-700 dark:text-gray-300",children:s.message})]}),e.jsx("div",{className:"mt-6",children:e.jsxs("a",{href:`mailto:${s.email}?subject=Re: Your message on my portfolio website`,className:"btn btn-primary px-4 py-2 inline-flex items-center gap-2",children:[e.jsx(o,{})," Reply via Email"]})})]})]}):e.jsxs("div",{className:"p-6 text-center text-gray-500 dark:text-gray-400",children:[e.jsx(o,{className:"w-12 h-12 mx-auto mb-4 opacity-30"}),e.jsx("p",{children:"Select a message to view its contents"})]})})]}):e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 text-center",children:[e.jsx(o,{className:"w-12 h-12 mx-auto mb-4 text-gray-300 dark:text-gray-600"}),e.jsx("h2",{className:"text-xl font-medium text-gray-800 dark:text-gray-200 mb-2",children:"No Messages Yet"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"There are no messages in your inbox. When visitors submit the contact form, their messages will appear here."})]})]})};export{S as default};
//# sourceMappingURL=Messages-QzMxWWtc.js.map
