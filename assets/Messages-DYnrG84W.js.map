{"version":3,"file":"Messages-DYnrG84W.js","sources":["../../src/pages/admin/Messages.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { FaEnvelope, FaEnvelopeOpen, FaTrash, FaCheck, FaTimes } from 'react-icons/fa';\r\nimport Loader from '../../components/Loader';\r\n\r\nconst API_URL = import.meta.env.VITE_API_URL || 'http://localhost:5000/api';\r\n\r\nconst Messages = () => {\r\n  const [messages, setMessages] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [selectedMessage, setSelectedMessage] = useState(null);\r\n  const [deleteConfirm, setDeleteConfirm] = useState(null);\r\n  const [actionLoading, setActionLoading] = useState(false);\r\n  \r\n  // Fetch messages\r\n  useEffect(() => {\r\n    const fetchMessages = async () => {\r\n      try {\r\n        setLoading(true);\r\n        const { data } = await axios.get(`${API_URL}/contact`);\r\n        \r\n        if (data.success) {\r\n          setMessages(data.contacts);\r\n        }\r\n      } catch (err) {\r\n        console.error('Error fetching messages:', err);\r\n        setError('Failed to load messages. Please try again later.');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    \r\n    fetchMessages();\r\n  }, []);\r\n  \r\n  // View message details\r\n  const handleViewMessage = async (message) => {\r\n    setSelectedMessage(message);\r\n    \r\n    // If message is unread, mark it as read\r\n    if (!message.isRead) {\r\n      try {\r\n        setActionLoading(true);\r\n        \r\n        const response = await axios.put(`${API_URL}/contact/${message._id}/read`);\r\n        \r\n        if (response.data.success) {\r\n          // Update message in state\r\n          setMessages(messages.map(msg => \r\n            msg._id === message._id ? { ...msg, isRead: true } : msg\r\n          ));\r\n          \r\n          // Update selected message\r\n          setSelectedMessage(prev => ({ ...prev, isRead: true }));\r\n        }\r\n      } catch (err) {\r\n        console.error('Error marking message as read:', err);\r\n      } finally {\r\n        setActionLoading(false);\r\n      }\r\n    }\r\n  };\r\n  \r\n  // Delete message\r\n  const handleDelete = async (messageId) => {\r\n    try {\r\n      setActionLoading(true);\r\n      \r\n      const response = await axios.delete(`${API_URL}/contact/${messageId}`);\r\n      \r\n      if (response.data.success) {\r\n        // Remove message from state\r\n        setMessages(prevMessages => prevMessages.filter(msg => msg._id !== messageId));\r\n        \r\n        // If the deleted message is the selected one, clear selection\r\n        if (selectedMessage && selectedMessage._id === messageId) {\r\n          setSelectedMessage(null);\r\n        }\r\n      }\r\n    } catch (err) {\r\n      console.error('Error deleting message:', err);\r\n      setError(err.response?.data?.message || 'Failed to delete message. Please try again.');\r\n    } finally {\r\n      setDeleteConfirm(null);\r\n      setActionLoading(false);\r\n    }\r\n  };\r\n  \r\n  // Format date from ISO string\r\n  const formatDate = (dateString) => {\r\n    const options = { year: 'numeric', month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' };\r\n    return new Date(dateString).toLocaleDateString(undefined, options);\r\n  };\r\n  \r\n  if (loading) return <Loader />;\r\n  \r\n  return (\r\n    <div>\r\n      <h1 className=\"text-2xl font-bold mb-2 text-gray-900 dark:text-white\">\r\n        Messages\r\n      </h1>\r\n      <p className=\"text-gray-600 dark:text-gray-400 mb-8\">\r\n        Manage contact form submissions\r\n      </p>\r\n      \r\n      {/* Error Message */}\r\n      {error && (\r\n        <div className=\"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 p-4 rounded-lg mb-6\">\r\n          <p>{error}</p>\r\n        </div>\r\n      )}\r\n      \r\n      {messages.length > 0 ? (\r\n        <div className=\"flex flex-col md:flex-row gap-6\">\r\n          {/* Messages List */}\r\n          <div className=\"w-full md:w-1/3 bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden\">\r\n            <h2 className=\"p-4 border-b border-gray-200 dark:border-gray-700 font-medium text-gray-800 dark:text-gray-200\">\r\n              All Messages ({messages.length})\r\n            </h2>\r\n            \r\n            <div className=\"overflow-y-auto max-h-[600px]\">\r\n              {messages.map((message) => (\r\n                <div \r\n                  key={message._id}\r\n                  onClick={() => handleViewMessage(message)}\r\n                  className={`p-4 border-b border-gray-200 dark:border-gray-700 cursor-pointer transition-colors duration-200 ${\r\n                    selectedMessage && selectedMessage._id === message._id\r\n                      ? 'bg-blue-50 dark:bg-blue-900/20'\r\n                      : 'hover:bg-gray-50 dark:hover:bg-gray-750'\r\n                  } ${\r\n                    !message.isRead ? 'bg-blue-50 dark:bg-blue-900/10' : ''\r\n                  }`}\r\n                >\r\n                  <div className=\"flex items-start gap-3\">\r\n                    <div className={`mt-1 ${!message.isRead ? 'text-blue-500' : 'text-gray-400 dark:text-gray-500'}`}>\r\n                      {!message.isRead ? <FaEnvelope /> : <FaEnvelopeOpen />}\r\n                    </div>\r\n                    \r\n                    <div className=\"flex-grow min-w-0\">\r\n                      <div className=\"flex justify-between items-start\">\r\n                        <h3 className={`font-medium truncate ${!message.isRead ? 'text-gray-900 dark:text-white' : 'text-gray-700 dark:text-gray-300'}`}>\r\n                          {message.name}\r\n                        </h3>\r\n                        <span className=\"text-xs text-gray-500 dark:text-gray-400 whitespace-nowrap ml-2\">\r\n                          {formatDate(message.createdAt).split(',')[0]}\r\n                        </span>\r\n                      </div>\r\n                      \r\n                      <p className=\"text-sm text-gray-500 dark:text-gray-400 truncate\">\r\n                        {message.email}\r\n                      </p>\r\n                      \r\n                      <p className=\"text-sm text-gray-600 dark:text-gray-400 mt-1 line-clamp-2\">\r\n                        {message.message}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n          \r\n          {/* Message Details */}\r\n          <div className=\"w-full md:w-2/3 bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden\">\r\n            {selectedMessage ? (\r\n              <div>\r\n                <div className=\"p-6 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center\">\r\n                  <h2 className=\"text-xl font-medium text-gray-800 dark:text-gray-200\">\r\n                    Message from {selectedMessage.name}\r\n                  </h2>\r\n                  \r\n                  <button\r\n                    onClick={() => setDeleteConfirm(selectedMessage._id)}\r\n                    disabled={actionLoading}\r\n                    className=\"text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300\"\r\n                    aria-label=\"Delete message\"\r\n                  >\r\n                    <FaTrash />\r\n                  </button>\r\n                </div>\r\n                \r\n                {deleteConfirm === selectedMessage._id && (\r\n                  <div className=\"m-4 p-3 bg-red-50 dark:bg-red-900/20 rounded-lg text-sm\">\r\n                    <p className=\"text-red-700 dark:text-red-400 mb-2\">\r\n                      Are you sure you want to delete this message?\r\n                    </p>\r\n                    <div className=\"flex justify-end space-x-2\">\r\n                      <button\r\n                        onClick={() => setDeleteConfirm(null)}\r\n                        className=\"px-3 py-1 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-300 dark:hover:bg-gray-600\"\r\n                      >\r\n                        <FaTimes className=\"inline mr-1\" /> Cancel\r\n                      </button>\r\n                      <button\r\n                        onClick={() => handleDelete(selectedMessage._id)}\r\n                        className=\"px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600\"\r\n                        disabled={actionLoading}\r\n                      >\r\n                        <FaCheck className=\"inline mr-1\" /> {actionLoading ? 'Deleting...' : 'Confirm'}\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n                \r\n                <div className=\"p-6\">\r\n                  <div className=\"mb-6\">\r\n                    <p className=\"text-sm text-gray-500 dark:text-gray-400 mb-1\">From:</p>\r\n                    <div className=\"flex flex-col sm:flex-row sm:items-center gap-2\">\r\n                      <p className=\"font-medium text-gray-900 dark:text-white\">{selectedMessage.name}</p>\r\n                      <p className=\"text-blue-600 dark:text-blue-400\">&lt;{selectedMessage.email}&gt;</p>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  <div className=\"mb-6\">\r\n                    <p className=\"text-sm text-gray-500 dark:text-gray-400 mb-1\">Date:</p>\r\n                    <p className=\"text-gray-700 dark:text-gray-300\">{formatDate(selectedMessage.createdAt)}</p>\r\n                  </div>\r\n                  \r\n                  <div>\r\n                    <p className=\"text-sm text-gray-500 dark:text-gray-400 mb-1\">Message:</p>\r\n                    <div className=\"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg whitespace-pre-wrap text-gray-700 dark:text-gray-300\">\r\n                      {selectedMessage.message}\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  <div className=\"mt-6\">\r\n                    <a\r\n                      href={`mailto:${selectedMessage.email}?subject=Re: Your message on my portfolio website`}\r\n                      className=\"btn btn-primary px-4 py-2 inline-flex items-center gap-2\"\r\n                    >\r\n                      <FaEnvelope /> Reply via Email\r\n                    </a>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              <div className=\"p-6 text-center text-gray-500 dark:text-gray-400\">\r\n                <FaEnvelope className=\"w-12 h-12 mx-auto mb-4 opacity-30\" />\r\n                <p>Select a message to view its contents</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      ) : (\r\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 text-center\">\r\n          <FaEnvelope className=\"w-12 h-12 mx-auto mb-4 text-gray-300 dark:text-gray-600\" />\r\n          <h2 className=\"text-xl font-medium text-gray-800 dark:text-gray-200 mb-2\">No Messages Yet</h2>\r\n          <p className=\"text-gray-600 dark:text-gray-400\">\r\n            There are no messages in your inbox. When visitors submit the contact form, their messages will appear here.\r\n          </p>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Messages; "],"names":["API_URL","Messages","messages","setMessages","useState","loading","setLoading","error","setError","selectedMessage","setSelectedMessage","deleteConfirm","setDeleteConfirm","actionLoading","setActionLoading","useEffect","data","axios","err","handleViewMessage","message","msg","prev","handleDelete","messageId","prevMessages","_b","_a","formatDate","dateString","options","jsx","Loader","jsxs","FaEnvelopeOpen","FaEnvelope","FaTrash","FaTimes","FaCheck"],"mappings":"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"}