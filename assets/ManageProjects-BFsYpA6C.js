import{u as R,r as l,j as e,L as O,w as U,I as q,i as I,J as H,K as J,M as W,P as B,Q as G,H as p}from"./index-ZFarn2BA.js";const w=I();console.log("ManageProjects component using API URL:",w);const V=()=>{const{user:K}=R(),[j,b]=l.useState([]),[A,L]=l.useState(!0),[F,k]=l.useState(null),[o,C]=l.useState("add"),[D,P]=l.useState(null),[f,u]=l.useState(!1),[a,m]=l.useState({title:"",description:"",technologies:"",liveLink:"",repoLink:"",featured:!1,order:0,image:null}),[i,S]=l.useState({}),[x,y]=l.useState(!1),[E,N]=l.useState(null);l.useEffect(()=>{(async()=>{try{L(!0);const{data:s}=await p.get("/projects");s.success&&b(s.projects)}catch(s){console.error("Error fetching projects:",s),k("Failed to load projects. Please try again later.")}finally{L(!1)}})()},[]);const c=t=>{const{name:s,value:d,type:r,checked:g,files:h}=t.target;if(r==="file"){m(n=>({...n,[s]:h[0]}));return}if(r==="checkbox"){m(n=>({...n,[s]:g}));return}m(n=>({...n,[s]:d}))},$=()=>{const t={};return a.title.trim()||(t.title="Title is required"),a.description.trim()||(t.description="Description is required"),a.technologies.trim()||(t.technologies="At least one technology is required"),o==="add"&&!a.image&&!a.imageUrl&&(t.image="Please select an image"),S(t),Object.keys(t).length===0},T=async t=>{var s,d;if(t.preventDefault(),!!$())try{y(!0);const r=new FormData;r.append("title",a.title),r.append("description",a.description);const g=a.technologies.split(",").map(n=>n.trim());r.append("technologies",JSON.stringify(g)),r.append("liveLink",a.liveLink),r.append("repoLink",a.repoLink),r.append("featured",a.featured),r.append("order",a.order),a.image&&r.append("image",a.image);let h;if(o==="add"?h=await p.post("/projects",r,{headers:{"Content-Type":"multipart/form-data"}}):h=await p.put(`/projects/${D._id}`,r,{headers:{"Content-Type":"multipart/form-data"}}),h.data.success){const{data:n}=await p.get("/projects");b(n.projects),v(),u(!1)}}catch(r){console.error("Error saving project:",r),k(((d=(s=r.response)==null?void 0:s.data)==null?void 0:d.message)||"Failed to save project. Please try again.")}finally{y(!1)}},_=t=>{C("edit"),P(t);const s=Array.isArray(t.technologies)?t.technologies.join(", "):"";m({title:t.title,description:t.description,technologies:s,liveLink:t.liveLink||"",repoLink:t.repoLink||"",featured:t.featured||!1,order:t.order||0,image:null,imageUrl:t.imageUrl}),u(!0)},M=async t=>{var s,d;try{y(!0),(await p.delete(`/projects/${t}`)).data.success&&b(j.filter(g=>g._id!==t))}catch(r){console.error("Error deleting project:",r),k(((d=(s=r.response)==null?void 0:s.data)==null?void 0:d.message)||"Failed to delete project. Please try again.")}finally{N(null),y(!1)}},v=()=>{m({title:"",description:"",technologies:"",liveLink:"",repoLink:"",featured:!1,order:0,image:null,imageUrl:null}),S({}),P(null),C("add")};return A?e.jsx(O,{}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Manage Projects"}),e.jsx("button",{onClick:()=>{v(),u(!f)},className:"btn btn-primary px-4 py-2 flex items-center gap-2",children:f?e.jsxs(e.Fragment,{children:[e.jsx(U,{})," Cancel"]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{})," Add Project"]})})]}),F&&e.jsx("div",{className:"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 p-4 rounded-lg mb-6",children:e.jsx("p",{children:F})}),f&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-800 dark:text-gray-200",children:o==="add"?"Add New Project":"Edit Project"}),e.jsxs("form",{onSubmit:T,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"title",className:"block text-gray-700 dark:text-gray-300 mb-2",children:"Title*"}),e.jsx("input",{type:"text",id:"title",name:"title",value:a.title,onChange:c,className:`input ${i.title?"border-red-500 dark:border-red-500":""}`,placeholder:"Project title"}),i.title&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.title})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"description",className:"block text-gray-700 dark:text-gray-300 mb-2",children:"Description*"}),e.jsx("textarea",{id:"description",name:"description",value:a.description,onChange:c,className:`textarea ${i.description?"border-red-500 dark:border-red-500":""}`,placeholder:"Project description",rows:4}),i.description&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.description})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"technologies",className:"block text-gray-700 dark:text-gray-300 mb-2",children:"Technologies* (comma separated)"}),e.jsx("input",{type:"text",id:"technologies",name:"technologies",value:a.technologies,onChange:c,className:`input ${i.technologies?"border-red-500 dark:border-red-500":""}`,placeholder:"React, Node.js, MongoDB, etc."}),i.technologies&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.technologies})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"liveLink",className:"block text-gray-700 dark:text-gray-300 mb-2",children:"Live Demo URL"}),e.jsx("input",{type:"url",id:"liveLink",name:"liveLink",value:a.liveLink,onChange:c,className:"input",placeholder:"https://example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"repoLink",className:"block text-gray-700 dark:text-gray-300 mb-2",children:"GitHub Repository URL"}),e.jsx("input",{type:"url",id:"repoLink",name:"repoLink",value:a.repoLink,onChange:c,className:"input",placeholder:"https://github.com/username/repo"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"flex items-center text-gray-700 dark:text-gray-300",children:[e.jsx("input",{type:"checkbox",name:"featured",checked:a.featured,onChange:c,className:"mr-2 h-4 w-4"}),"Featured Project"]})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"order",className:"block text-gray-700 dark:text-gray-300 mb-2",children:"Display Order"}),e.jsx("input",{type:"number",id:"order",name:"order",value:a.order,onChange:c,className:"input",min:"0",step:"1"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{htmlFor:"image",className:"block text-gray-700 dark:text-gray-300 mb-2",children:["Project Image ",o==="add"&&"*"]}),o==="edit"&&a.imageUrl&&e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"Current image:"}),e.jsx("img",{src:a.imageUrl.startsWith("http")?a.imageUrl:`${w}${a.imageUrl}`,alt:"Current project",className:"h-32 object-cover rounded-md"})]}),e.jsx("input",{type:"file",id:"image",name:"image",onChange:c,className:`block w-full text-gray-700 dark:text-gray-300 ${i.image?"border-red-500 dark:border-red-500":""}`,accept:"image/*"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:o==="edit"?"Leave empty to keep current image":"Select a project image"}),i.image&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.image})]}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("button",{type:"button",onClick:()=>{v(),u(!1)},className:"btn btn-outline mr-2",disabled:x,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:x,className:`btn btn-primary ${x?"opacity-70 cursor-not-allowed":""}`,children:x?"Saving...":o==="add"?"Add Project":"Update Project"})]})]})]}),j.length>0?e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Project"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Technologies"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Featured"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Order"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:j.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 flex-shrink-0 rounded overflow-hidden bg-gray-100",children:e.jsx("img",{src:t.imageUrl.startsWith("http")?t.imageUrl:`${w}${t.imageUrl}`,alt:t.title,className:"h-10 w-10 object-cover"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.title}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 truncate max-w-xs",children:t.description.length>60?`${t.description.substring(0,60)}...`:t.description})]})]})}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[t.technologies.slice(0,3).map((s,d)=>e.jsx("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 text-xs rounded",children:s},d)),t.technologies.length>3&&e.jsxs("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 text-xs rounded",children:["+",t.technologies.length-3]})]})}),e.jsx("td",{className:"px-4 py-4",children:t.featured?e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-400",children:[e.jsx(H,{className:"mr-1"})," Featured"]}):e.jsx("span",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"No"})}),e.jsx("td",{className:"px-4 py-4 text-sm text-gray-700 dark:text-gray-300",children:t.order}),e.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("a",{href:t.liveLink,target:"_blank",rel:"noopener noreferrer",className:`text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 ${!t.liveLink&&"pointer-events-none opacity-40"}`,"aria-label":"View live demo",children:e.jsx(J,{})}),e.jsx("button",{onClick:()=>_(t),className:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300","aria-label":"Edit project",children:e.jsx(W,{})}),e.jsx("button",{onClick:()=>N(t._id),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300","aria-label":"Delete project",children:e.jsx(B,{})})]}),E===t._id&&e.jsxs("div",{className:"mt-2 bg-red-50 dark:bg-red-900/20 p-2 rounded text-left",children:[e.jsx("p",{className:"text-xs text-red-700 dark:text-red-400 mb-2",children:"Are you sure you want to delete this project?"}),e.jsxs("div",{className:"flex space-x-2 justify-end",children:[e.jsxs("button",{onClick:()=>N(null),className:"px-2 py-1 text-xs bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-300 dark:hover:bg-gray-600",children:[e.jsx(U,{className:"inline mr-1"})," Cancel"]}),e.jsxs("button",{onClick:()=>M(t._id),className:"px-2 py-1 text-xs bg-red-500 text-white rounded hover:bg-red-600",disabled:x,children:[e.jsx(G,{className:"inline mr-1"})," ",x?"Deleting...":"Confirm"]})]})]})]})]},t._id))})]})})}):e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 text-center",children:e.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:'No projects found. Click "Add Project" to create your first project.'})})]})};export{V as default};
//# sourceMappingURL=ManageProjects-BFsYpA6C.js.map
